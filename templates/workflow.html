{% extends 'base.html' %}

{% block title %}å·¥ä½œæµ - æœåŠ¡å™¨ç®¡ç†ç³»ç»Ÿ{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/workflow.css') }}">
{% endblock %}

{% block header_content %}
<div>
    <h1>å·¥ä½œæµç¼–è¾‘å™¨</h1>
</div>
<div class="top-actions">
    <div class="zoom-controls">
        <button id="zoom-out" class="btn btn-secondary" title="ç¼©å°">-</button>
        <span id="zoom-level">100%</span>
        <button id="zoom-in" class="btn btn-secondary" title="æ”¾å¤§">+</button>
        <button id="zoom-reset" class="btn btn-secondary" title="é‡ç½®">é‡ç½®</button>
    </div>
    <button id="clear-btn" class="btn btn-secondary">æ¸…ç©ºç”»å¸ƒ</button>
    <button id="run-btn" class="btn btn-primary">è¿è¡Œå·¥ä½œæµ</button>
</div>
{% endblock %}

{% block content %}
<div class="content workflow-content">
    <div class="workflow-container">
        <div class="workspace">
            <div id="canvas" class="canvas">
                <div id="canvas-content" class="canvas-content">
                    <svg id="connections" class="connections-layer"></svg>
                </div>
                <aside class="component-panel draggable-panel">
                    <div class="panel-header">
                        <h3>ç»„ä»¶åº“</h3>
                        <div class="drag-handle">âœ¥</div>
                    </div>
                    <div class="component-section">
                        <h4>æœåŠ¡å™¨</h4>
                        <div id="server-list" class="draggable-items"></div>
                    </div>
                    <div class="component-section">
                        <h4>äº‹ä»¶</h4>
                        <div class="draggable-items">
                            <div class="draggable-item" draggable="true" data-type="upload">
                                <span class="icon">â¬†ï¸</span>
                                <span>ä¸Šä¼ æ–‡ä»¶</span>
                            </div>
                            <div class="draggable-item" draggable="true" data-type="command">
                                <span class="icon">âš¡</span>
                                <span>æ‰§è¡Œå‘½ä»¤</span>
                            </div>
                            <div class="draggable-item" draggable="true" data-type="output">
                                <span class="icon">ğŸ“‹</span>
                                <span>ç»“æœæ˜¾ç¤º</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
            <div class="splitter" id="workspace-splitter"></div>
            <aside class="result-panel">
                <h3>æ‰§è¡Œç»“æœ</h3>
                <div id="output-container">
                    <!-- åŠ¨æ€ç”Ÿæˆå†…å®¹ -->
                </div>
            </aside>
        </div>
    </div>
</div>

<div id="command-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ç¼–è¾‘å‘½ä»¤</h3>
            <span class="close">&times;</span>
        </div>
        <div class="modal-body">
            <label for="command-input">å‘½ä»¤</label>
            <input type="text" id="command-input" class="form-input" placeholder="ä¾‹å¦‚: ls -la">
            <label for="command-description">æè¿°</label>
            <input type="text" id="command-description" class="form-input" placeholder="æè¿°">
        </div>
        <div class="modal-footer">
            <button id="cancel-command" class="btn btn-secondary">å–æ¶ˆ</button>
            <button id="save-command" class="btn btn-primary">ä¿å­˜</button>
        </div>
    </div>
</div>
<div id="upload-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ä¸Šä¼ æ–‡ä»¶</h3>
            <span class="close">&times;</span>
        </div>
        <div class="modal-body">
            <label for="upload-file">é€‰æ‹©æ–‡ä»¶</label>
            <div id="current-file-info" style="margin-bottom: 10px; font-size: 12px; color: #666;"></div>
            <input type="file" id="upload-file" class="form-input">
            <label for="remote-path">è¿œç¨‹è·¯å¾„</label>
            <input type="text" id="remote-path" class="form-input" placeholder="/tmp/upload.bin">
        </div>
        <div class="modal-footer">
            <button id="cancel-upload" class="btn btn-secondary">å–æ¶ˆ</button>
            <button id="save-upload" class="btn btn-primary">ä¿å­˜</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/workflow.js') }}"></script>
{% endblock %}
